import{r as u,j as e,c as S,R as z}from"./react-vendor.Ds7D3P6J.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const x of o.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&c(x)}).observe(document,{childList:!0,subtree:!0});function m(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(a){if(a.ep)return;a.ep=!0;const o=m(a);fetch(a.href,o)}})();const E=({pixelsPerCm:f,onCreateLine:r})=>{const[m,c]=u.useState({width:0,height:0});u.useEffect(()=>{const i=()=>{c({width:window.innerWidth,height:window.innerHeight})};return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]);const a=Math.ceil((m.width-50)/f)+10,o=Math.ceil((m.height-50)/f)+10,x=(i,l)=>{i.preventDefault(),i.stopPropagation();const d="touches"in i?l?i.touches[0].clientY:i.touches[0].clientX:l?i.clientY:i.clientX,j=d-50;r(l,j)};return e.jsxs("div",{className:"ruler",children:[e.jsx("div",{className:"horizontal-ruler",onClick:i=>x(i,!1),onTouchStart:i=>x(i,!1),children:Array.from({length:a*10+1}).map((i,l)=>{const d=l%10===0,j=l%5===0;return e.jsx("div",{className:`tick ${d?"cm":j?"mm5":"mm"}`,style:{left:`${l*f/10}px`},children:d&&e.jsx("span",{className:"label",children:l/10})},l)})}),e.jsx("div",{className:"vertical-ruler",onClick:i=>x(i,!0),onTouchStart:i=>x(i,!0),children:Array.from({length:o*10+1}).map((i,l)=>{const d=l%10===0,j=l%5===0;return e.jsx("div",{className:`tick ${d?"cm":j?"mm5":"mm"}`,style:{top:`${l*f/10}px`},children:d&&e.jsx("span",{className:"label",children:l/10})},l)})})]})},y=({onCalibrate:f,onClose:r,currentPixelsPerCm:m})=>{const[c,a]=u.useState(10),[o,x]=u.useState(10),i=u.useRef(null),l=h=>{i.current&&!i.current.contains(h.target)&&r()};u.useEffect(()=>{const h=p=>{i.current&&!i.current.contains(p.target)&&r()};return document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[r]);const d=h=>(10/h).toFixed(3),j=h=>{const p=parseFloat(h.target.value);!isNaN(p)&&p>0&&a(p)},N=h=>{const p=parseFloat(h.target.value);!isNaN(p)&&p>0&&x(p)};return e.jsx("div",{className:"calibration-modal",onClick:l,children:e.jsxs("div",{className:"modal-content",ref:i,onClick:h=>h.stopPropagation(),children:[e.jsx("div",{className:"modal-header",children:e.jsx("h2",{children:"Screen Calibration"})}),e.jsxs("div",{className:"modal-body",children:[m&&e.jsxs("div",{className:"current-calibration",children:[e.jsx("p",{children:"Current calibration:"}),e.jsxs("div",{className:"calibration-values",children:[e.jsxs("div",{children:[m.toFixed(5)," pixels/cm"]}),e.jsxs("div",{children:[d(m)," mm/pixel"]})]})]}),e.jsx("div",{className:"calibration-methods",children:m&&e.jsxs("div",{className:"method",children:[e.jsx("h3",{children:"Adjust Current Calibration"}),e.jsx("p",{children:"Fine-tune the current calibration by setting a ratio. For example, to make measurements 10% larger, set 11 / 10."}),e.jsxs("div",{className:"control ratio-control",children:[e.jsxs("div",{className:"ratio-inputs",children:[e.jsx("input",{type:"number",value:c,onChange:j,min:"0.1",step:"0.1"}),e.jsx("span",{className:"ratio-divider",children:"/"}),e.jsx("input",{type:"number",value:o,onChange:N,min:"0.1",step:"0.1"})]}),e.jsxs("div",{className:"ratio-preview",children:["Current adjustment: ",(c/o*100).toFixed(1),"%"]}),c!==o&&e.jsxs("div",{className:"new-calibration-preview",children:["New calibration will be:",e.jsxs("div",{className:"calibration-values",children:[e.jsxs("div",{children:[(m*(c/o)).toFixed(2)," pixels/cm"]}),e.jsxs("div",{children:[d(m*(c/o))," mm/pixel"]})]})]}),e.jsx("button",{onClick:()=>f(m*(c/o)),children:"Apply"})]})]})})]})]})})},M=({pixelsPerCm:f,lines:r,onLinesChange:m,showMeasurements:c,onToggleMeasurements:a})=>{const[o,x]=u.useState(null),[i,l]=u.useState([]),[d,j]=u.useState(null),N=(t,s)=>{s.preventDefault();const v=r.find(g=>g.id===t);if(!v)return;x(t);const n="touches"in s?v.isHorizontal?s.touches[0].clientY:s.touches[0].clientX:v.isHorizontal?s.clientY:s.clientX;j({position:v.position,mousePosition:n})},h=(t,s)=>{t.preventDefault(),t.stopPropagation(),m(r.filter(v=>v.id!==s))},p=u.useCallback(t=>{if(!o||!d)return;const s=r.find(b=>b.id===o);if(!s)return;const n=("touches"in t?s.isHorizontal?t.touches[0].clientY:t.touches[0].clientX:s.isHorizontal?t.clientY:t.clientX)-d.mousePosition,g=d.position+n*.1;m(r.map(b=>b.id===o?{...b,position:g}:b))},[o,d,r,m]),w=()=>{x(null),j(null)};return u.useEffect(()=>{const t=r.filter(n=>n.isHorizontal).sort((n,g)=>n.position-g.position),s=r.filter(n=>!n.isHorizontal).sort((n,g)=>n.position-g.position),v=[];for(let n=0;n<t.length-1;n++){const b=Math.abs(t[n+1].position-t[n].position)/f;v.push({id:`${t[n].id}-${t[n+1].id}`,value:Number(b.toFixed(2)),unit:"cm",startLine:t[n].id,endLine:t[n+1].id,isHorizontal:!0})}for(let n=0;n<s.length-1;n++){const b=Math.abs(s[n+1].position-s[n].position)/f;v.push({id:`${s[n].id}-${s[n+1].id}`,value:Number(b.toFixed(2)),unit:"cm",startLine:s[n].id,endLine:s[n+1].id,isHorizontal:!1})}l(v)},[r,f]),u.useEffect(()=>(o&&(window.addEventListener("mousemove",p),window.addEventListener("mouseup",w),window.addEventListener("touchmove",p),window.addEventListener("touchend",w)),()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",w),window.removeEventListener("touchmove",p),window.removeEventListener("touchend",w)}),[o,p]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"measurement-lines",children:[r.map(t=>e.jsx("div",{className:`measurement-line ${t.isHorizontal?"horizontal":"vertical"}`,style:{[t.isHorizontal?"top":"left"]:`${t.position}px`},onMouseDown:s=>N(t.id,s),onTouchStart:s=>N(t.id,s),onDoubleClick:s=>h(s,t.id),onTouchEnd:s=>{s.timeStamp-s.currentTarget.lastTouch<500&&h(s,t.id),s.currentTarget.lastTouch=s.timeStamp},title:"Double-tap to delete, drag to move"},t.id)),i.map(t=>{const s=r.find(L=>L.id===t.startLine),v=r.find(L=>L.id===t.endLine);if(!s||!v)return null;const n=(s.position+v.position)/2,g=`${t.value}${t.unit}`,b=t.isHorizontal?[{left:"60px",top:`${n}px`,transform:"translateY(-50%)"},{right:"60px",top:`${n}px`,transform:"translateY(-50%)"}]:[{top:"60px",left:`${n}px`,transform:"translateX(-50%)"},{bottom:"60px",left:`${n}px`,transform:"translateX(-50%)"}];return e.jsx(e.Fragment,{children:b.map((L,C)=>e.jsx("div",{className:"measurement-label",style:L,children:g},`${t.id}-${C}`))})})]}),r.length>=2&&e.jsxs("div",{className:`measurements-display ${c?"":"minimized"}`,children:[e.jsxs("div",{className:"measurements-header",children:[e.jsx("h3",{children:"Measurements"}),e.jsx("button",{className:"minimize-button",onClick:a,title:c?"Minimize":"Maximize",children:c?"âˆ’":"+"})]}),c&&e.jsxs("div",{className:"measurement-list",children:[e.jsxs("div",{className:"measurement-section",children:[e.jsx("h4",{children:"Horizontal"}),i.filter(t=>t.isHorizontal).map(t=>e.jsxs("div",{className:"measurement-item",children:[t.value,t.unit]},t.id))]}),e.jsxs("div",{className:"measurement-section",children:[e.jsx("h4",{children:"Vertical"}),i.filter(t=>!t.isHorizontal).map(t=>e.jsxs("div",{className:"measurement-item",children:[t.value,t.unit]},t.id))]})]})]})]})};function F(){const[f,r]=u.useState(()=>{const s=localStorage.getItem("pixelsPerCm");return s?parseFloat(s):37.795275591}),[m,c]=u.useState(!1),[a,o]=u.useState([]),[x,i]=u.useState(!0),[l,d]=u.useState(!0),[j,N]=u.useState(!1),h=s=>{r(s),localStorage.setItem("pixelsPerCm",s.toString())},p=(s,v)=>{o(n=>[...n,{id:Math.random().toString(36).substr(2,9),position:v,isHorizontal:s}]),i(!1),d(!0)},w=u.useCallback(async()=>{try{document.fullscreenElement?(await document.exitFullscreen(),N(!1)):(await document.documentElement.requestFullscreen(),N(!0))}catch(s){console.error("Error toggling fullscreen:",s)}},[]),t=()=>{o([])};return e.jsxs("div",{className:"app",children:[e.jsxs("div",{className:"top-buttons",children:[e.jsx("button",{className:"calibrate-button",onClick:()=>c(!0),children:"Calibrate"}),e.jsx("button",{className:"toggle-fullscreen-button",onClick:w,children:j?"Exit Fullscreen":"Fullscreen"}),e.jsx("button",{className:"reset-button",onClick:t,children:"Reset"})]}),x&&e.jsx("div",{className:"measurement-instructions",children:e.jsxs("div",{className:"instruction-box",children:[e.jsx("h3",{children:"How to Use:"}),e.jsxs("ol",{children:[e.jsx("li",{children:"Double-click on the top ruler to create vertical lines"}),e.jsx("li",{children:"Double-click on the left ruler to create horizontal lines"}),e.jsx("li",{children:"Drag lines to measure distances"}),e.jsx("li",{children:"Use the minimize button to hide/show measurements panel"})]})]})}),e.jsx(E,{pixelsPerCm:f,onCreateLine:p}),e.jsx(M,{pixelsPerCm:f,lines:a,onLinesChange:o,showMeasurements:l,onToggleMeasurements:()=>d(!l)}),m&&e.jsx(y,{onCalibrate:h,onClose:()=>c(!1),currentPixelsPerCm:f})]})}S.createRoot(document.getElementById("root")).render(e.jsx(z.StrictMode,{children:e.jsx(F,{})}));
