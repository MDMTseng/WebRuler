import{r as m,j as e,c as L,R as S}from"./react-vendor.Ds7D3P6J.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))h(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const j of o.addedNodes)j.tagName==="LINK"&&j.rel==="modulepreload"&&h(j)}).observe(document,{childList:!0,subtree:!0});function v(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function h(r){if(r.ep)return;r.ep=!0;const o=v(r);fetch(r.href,o)}})();const z=({pixelsPerCm:p,onCreateLine:c})=>{const[v,h]=m.useState({width:0,height:0}),[r,o]=m.useState(!1);m.useEffect(()=>{const i=()=>{h({width:window.innerWidth,height:window.innerHeight})};return o("ontouchstart"in window),i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]);const j=Math.ceil((v.width-50)/p)+10,f=Math.ceil((v.height-50)/p)+10,b=(i,l)=>{if(r)return;i.preventDefault(),i.stopPropagation();const u=(l?i.clientY:i.clientX)-50;c(l,u)},x=(i,l)=>{i.preventDefault(),i.stopPropagation();const u=(l?i.touches[0].clientY:i.touches[0].clientX)-50;c(l,u)};return e.jsxs("div",{className:"ruler",children:[e.jsx("div",{className:"horizontal-ruler",onClick:r?void 0:i=>b(i,!1),onTouchStart:r?i=>x(i,!1):void 0,onTouchMove:i=>i.preventDefault(),children:Array.from({length:j*10+1}).map((i,l)=>{const a=l%10===0,u=l%5===0;return e.jsx("div",{className:`tick ${a?"cm":u?"mm5":"mm"}`,style:{left:`${l*p/10}px`},children:a&&e.jsx("span",{className:"label",children:l/10})},l)})}),e.jsx("div",{className:"vertical-ruler",onClick:r?void 0:i=>b(i,!0),onTouchStart:r?i=>x(i,!0):void 0,onTouchMove:i=>i.preventDefault(),children:Array.from({length:f*10+1}).map((i,l)=>{const a=l%10===0,u=l%5===0;return e.jsx("div",{className:`tick ${a?"cm":u?"mm5":"mm"}`,style:{top:`${l*p/10}px`},children:a&&e.jsx("span",{className:"label",children:l/10})},l)})})]})},C=({onCalibrate:p,onClose:c,currentPixelsPerCm:v})=>{const[h,r]=m.useState(10),[o,j]=m.useState(10),f=m.useRef(null),b=a=>{f.current&&!f.current.contains(a.target)&&c()};m.useEffect(()=>{const a=u=>{f.current&&!f.current.contains(u.target)&&c()};return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[c]);const x=a=>(10/a).toFixed(3),i=a=>{const u=parseFloat(a.target.value);!isNaN(u)&&u>0&&r(u)},l=a=>{const u=parseFloat(a.target.value);!isNaN(u)&&u>0&&j(u)};return e.jsx("div",{className:"calibration-modal",onClick:b,children:e.jsxs("div",{className:"modal-content",ref:f,onClick:a=>a.stopPropagation(),children:[e.jsx("div",{className:"modal-header",children:e.jsx("h2",{children:"Screen Calibration"})}),e.jsxs("div",{className:"modal-body",children:[v&&e.jsxs("div",{className:"current-calibration",children:[e.jsx("p",{children:"Current calibration:"}),e.jsxs("div",{className:"calibration-values",children:[e.jsxs("div",{children:[v.toFixed(5)," pixels/cm"]}),e.jsxs("div",{children:[x(v)," mm/pixel"]})]})]}),e.jsx("div",{className:"calibration-methods",children:v&&e.jsxs("div",{className:"method",children:[e.jsx("h3",{children:"Adjust Current Calibration"}),e.jsx("p",{children:"Fine-tune the current calibration by setting a ratio. For example, to make measurements 10% larger, set 11 / 10."}),e.jsxs("div",{className:"control ratio-control",children:[e.jsxs("div",{className:"ratio-inputs",children:[e.jsx("input",{type:"number",value:h,onChange:i,min:"0.1",step:"0.1"}),e.jsx("span",{className:"ratio-divider",children:"/"}),e.jsx("input",{type:"number",value:o,onChange:l,min:"0.1",step:"0.1"})]}),e.jsxs("div",{className:"ratio-preview",children:["Current adjustment: ",(h/o*100).toFixed(1),"%"]}),h!==o&&e.jsxs("div",{className:"new-calibration-preview",children:["New calibration will be:",e.jsxs("div",{className:"calibration-values",children:[e.jsxs("div",{children:[(v*(h/o)).toFixed(2)," pixels/cm"]}),e.jsxs("div",{children:[x(v*(h/o))," mm/pixel"]})]})]}),e.jsx("button",{onClick:()=>p(v*(h/o)),children:"Apply"})]})]})})]})]})})},M=({pixelsPerCm:p,lines:c,onLinesChange:v,showMeasurements:h,onToggleMeasurements:r})=>{const[o,j]=m.useState(null),[f,b]=m.useState([]),[x,i]=m.useState(null),l=(n,t)=>{t.preventDefault();const d=c.find(w=>w.id===n);if(!d)return;j(n);const s="touches"in t?d.isHorizontal?t.touches[0].clientY:t.touches[0].clientX:d.isHorizontal?t.clientY:t.clientX;i({position:d.position,mousePosition:s})},a=(n,t)=>{n.preventDefault(),n.stopPropagation(),v(c.filter(d=>d.id!==t))},u=m.useCallback(n=>{if(!o||!x)return;const t=c.find(g=>g.id===o);if(!t)return;const s=("touches"in n?t.isHorizontal?n.touches[0].clientY:n.touches[0].clientX:t.isHorizontal?n.clientY:n.clientX)-x.mousePosition,w=x.position+s*.1;v(c.map(g=>g.id===o?{...g,position:w}:g))},[o,x,c,v]),E=()=>{j(null),i(null)};return m.useEffect(()=>{const n=c.filter(s=>s.isHorizontal).sort((s,w)=>s.position-w.position),t=c.filter(s=>!s.isHorizontal).sort((s,w)=>s.position-w.position),d=[];for(let s=0;s<n.length-1;s++){const g=Math.abs(n[s+1].position-n[s].position)/p;d.push({id:`${n[s].id}-${n[s+1].id}`,value:Number(g.toFixed(2)),unit:"cm",startLine:n[s].id,endLine:n[s+1].id,isHorizontal:!0})}for(let s=0;s<t.length-1;s++){const g=Math.abs(t[s+1].position-t[s].position)/p;d.push({id:`${t[s].id}-${t[s+1].id}`,value:Number(g.toFixed(2)),unit:"cm",startLine:t[s].id,endLine:t[s+1].id,isHorizontal:!1})}b(d)},[c,p]),m.useEffect(()=>(o&&(window.addEventListener("mousemove",u),window.addEventListener("mouseup",E),window.addEventListener("touchmove",u),window.addEventListener("touchend",E)),()=>{window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",E),window.removeEventListener("touchmove",u),window.removeEventListener("touchend",E)}),[o,u]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"measurement-lines",children:[c.map(n=>e.jsx("div",{className:`measurement-line ${n.isHorizontal?"horizontal":"vertical"}`,style:{[n.isHorizontal?"top":"left"]:`${n.position}px`},onMouseDown:t=>l(n.id,t),onTouchStart:t=>l(n.id,t),onDoubleClick:t=>a(t,n.id),onTouchEnd:t=>{t.timeStamp-t.currentTarget.lastTouch<500&&a(t,n.id),t.currentTarget.lastTouch=t.timeStamp},title:"Double-tap to delete, drag to move"},n.id)),f.map(n=>{const t=c.find(N=>N.id===n.startLine),d=c.find(N=>N.id===n.endLine);if(!t||!d)return null;const s=(t.position+d.position)/2,w=`${n.value}${n.unit}`,g=n.isHorizontal?[{left:"60px",top:`${s}px`,transform:"translateY(-50%)"},{right:"60px",top:`${s}px`,transform:"translateY(-50%)"}]:[{top:"60px",left:`${s}px`,transform:"translateX(-50%)"},{bottom:"60px",left:`${s}px`,transform:"translateX(-50%)"}];return e.jsx(e.Fragment,{children:g.map((N,F)=>e.jsx("div",{className:"measurement-label",style:N,children:w},`${n.id}-${F}`))})})]}),c.length>=2&&e.jsxs("div",{className:`measurements-display ${h?"":"minimized"}`,children:[e.jsxs("div",{className:"measurements-header",children:[e.jsx("h3",{children:"Measurements"}),e.jsx("button",{className:"minimize-button",onClick:r,title:h?"Minimize":"Maximize",children:h?"âˆ’":"+"})]}),h&&e.jsxs("div",{className:"measurement-list",children:[e.jsxs("div",{className:"measurement-section",children:[e.jsx("h4",{children:"Horizontal"}),f.filter(n=>n.isHorizontal).map(n=>e.jsxs("div",{className:"measurement-item",children:[n.value,n.unit]},n.id))]}),e.jsxs("div",{className:"measurement-section",children:[e.jsx("h4",{children:"Vertical"}),f.filter(n=>!n.isHorizontal).map(n=>e.jsxs("div",{className:"measurement-item",children:[n.value,n.unit]},n.id))]})]})]})]})};function y(){const[p,c]=m.useState(()=>{const t=localStorage.getItem("pixelsPerCm");return t?parseFloat(t):37.795275591}),[v,h]=m.useState(!1),[r,o]=m.useState([]),[j,f]=m.useState(!0),[b,x]=m.useState(!0),[i,l]=m.useState(!1),a=t=>{c(t),localStorage.setItem("pixelsPerCm",t.toString())},u=(t,d)=>{o(s=>[...s,{id:Math.random().toString(36).substr(2,9),position:d,isHorizontal:t}]),f(!1),x(!0)},E=m.useCallback(async()=>{try{const t=document.documentElement;!document.fullscreenElement&&!document.webkitFullscreenElement&&!document.mozFullScreenElement&&!document.msFullscreenElement?(t.requestFullscreen?await t.requestFullscreen():t.webkitRequestFullscreen?await t.webkitRequestFullscreen():t.mozRequestFullScreen?await t.mozRequestFullScreen():t.msRequestFullscreen&&await t.msRequestFullscreen(),l(!0)):(document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen(),l(!1))}catch(t){console.error("Error toggling fullscreen:",t)}},[]);m.useEffect(()=>{const t=()=>{l(!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement))};return document.addEventListener("fullscreenchange",t),document.addEventListener("webkitfullscreenchange",t),document.addEventListener("mozfullscreenchange",t),document.addEventListener("MSFullscreenChange",t),()=>{document.removeEventListener("fullscreenchange",t),document.removeEventListener("webkitfullscreenchange",t),document.removeEventListener("mozfullscreenchange",t),document.removeEventListener("MSFullscreenChange",t)}},[]),m.useEffect(()=>{if(!document.querySelector("meta[name=viewport]")){const d=document.createElement("meta");d.name="viewport",d.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no",document.head.appendChild(d)}},[]);const n=()=>{o([])};return m.useEffect(()=>{const t=d=>{d.touches.length===1&&d.preventDefault()};return document.addEventListener("touchmove",t,{passive:!1}),()=>{document.removeEventListener("touchmove",t)}},[]),e.jsxs("div",{className:"app",children:[e.jsxs("div",{className:"top-buttons",children:[e.jsx("button",{className:"calibrate-button",onClick:()=>h(!0),children:"Calibrate"}),e.jsx("button",{className:"toggle-fullscreen-button",onClick:E,children:i?"Exit Fullscreen":"Fullscreen"}),e.jsx("button",{className:"reset-button",onClick:n,children:"Reset"})]}),j&&e.jsx("div",{className:"measurement-instructions",children:e.jsxs("div",{className:"instruction-box",children:[e.jsx("h3",{children:"How to Use:"}),e.jsxs("ol",{children:[e.jsx("li",{children:"Double-click on the top ruler to create vertical lines"}),e.jsx("li",{children:"Double-click on the left ruler to create horizontal lines"}),e.jsx("li",{children:"Drag lines to measure distances"}),e.jsx("li",{children:"Use the minimize button to hide/show measurements panel"})]})]})}),e.jsx(z,{pixelsPerCm:p,onCreateLine:u}),e.jsx(M,{pixelsPerCm:p,lines:r,onLinesChange:o,showMeasurements:b,onToggleMeasurements:()=>x(!b)}),v&&e.jsx(C,{onCalibrate:a,onClose:()=>h(!1),currentPixelsPerCm:p})]})}L.createRoot(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(y,{})}));
