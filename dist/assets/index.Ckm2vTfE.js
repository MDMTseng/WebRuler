import{r as u,j as e,c as S,R as C}from"./react-vendor.Ds7D3P6J.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))m(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const j of o.addedNodes)j.tagName==="LINK"&&j.rel==="modulepreload"&&m(j)}).observe(document,{childList:!0,subtree:!0});function p(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function m(r){if(r.ep)return;r.ep=!0;const o=p(r);fetch(r.href,o)}})();const z=({pixelsPerCm:v,onCreateLine:a})=>{const[p,m]=u.useState({width:0,height:0}),[r,o]=u.useState(!1);u.useEffect(()=>{const i=()=>{m({width:window.innerWidth,height:window.innerHeight})};return o("ontouchstart"in window),i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]);const j=Math.ceil((p.width-50)/v)+10,f=Math.ceil((p.height-50)/v)+10,N=(i,l)=>{if(r)return;i.preventDefault(),i.stopPropagation();const d=(l?i.clientY:i.clientX)-50;a(l,d)},x=(i,l)=>{i.preventDefault(),i.stopPropagation();const d=(l?i.touches[0].clientY:i.touches[0].clientX)-50;a(l,d)};return e.jsxs("div",{className:"ruler",children:[e.jsx("div",{className:"horizontal-ruler",onClick:r?void 0:i=>N(i,!1),onTouchStart:r?i=>x(i,!1):void 0,onTouchMove:i=>i.preventDefault(),children:Array.from({length:j*10+1}).map((i,l)=>{const c=l%10===0,d=l%5===0;return e.jsx("div",{className:`tick ${c?"cm":d?"mm5":"mm"}`,style:{left:`${l*v/10}px`},children:c&&e.jsx("span",{className:"label",children:l/10})},l)})}),e.jsx("div",{className:"vertical-ruler",onClick:r?void 0:i=>N(i,!0),onTouchStart:r?i=>x(i,!0):void 0,onTouchMove:i=>i.preventDefault(),children:Array.from({length:f*10+1}).map((i,l)=>{const c=l%10===0,d=l%5===0;return e.jsx("div",{className:`tick ${c?"cm":d?"mm5":"mm"}`,style:{top:`${l*v/10}px`},children:c&&e.jsx("span",{className:"label",children:l/10})},l)})})]})},M=({onCalibrate:v,onClose:a,currentPixelsPerCm:p})=>{const[m,r]=u.useState(10),[o,j]=u.useState(10),f=u.useRef(null),N=c=>{f.current&&!f.current.contains(c.target)&&a()};u.useEffect(()=>{const c=d=>{f.current&&!f.current.contains(d.target)&&a()};return document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[a]);const x=c=>(10/c).toFixed(3),i=c=>{const d=parseFloat(c.target.value);!isNaN(d)&&d>0&&r(d)},l=c=>{const d=parseFloat(c.target.value);!isNaN(d)&&d>0&&j(d)};return e.jsx("div",{className:"calibration-modal",onClick:N,children:e.jsxs("div",{className:"modal-content",ref:f,onClick:c=>c.stopPropagation(),children:[e.jsx("div",{className:"modal-header",children:e.jsx("h2",{children:"Screen Calibration"})}),e.jsxs("div",{className:"modal-body",children:[p&&e.jsxs("div",{className:"current-calibration",children:[e.jsx("p",{children:"Current calibration:"}),e.jsxs("div",{className:"calibration-values",children:[e.jsxs("div",{children:[p.toFixed(5)," pixels/cm"]}),e.jsxs("div",{children:[x(p)," mm/pixel"]})]})]}),e.jsx("div",{className:"calibration-methods",children:p&&e.jsxs("div",{className:"method",children:[e.jsx("h3",{children:"Adjust Current Calibration"}),e.jsx("p",{children:"Fine-tune the current calibration by setting a ratio. For example, to make measurements 10% larger, set 11 / 10."}),e.jsxs("div",{className:"control ratio-control",children:[e.jsxs("div",{className:"ratio-inputs",children:[e.jsx("input",{type:"number",value:m,onChange:i,min:"0.1",step:"0.1"}),e.jsx("span",{className:"ratio-divider",children:"/"}),e.jsx("input",{type:"number",value:o,onChange:l,min:"0.1",step:"0.1"})]}),e.jsxs("div",{className:"ratio-preview",children:["Current adjustment: ",(m/o*100).toFixed(1),"%"]}),m!==o&&e.jsxs("div",{className:"new-calibration-preview",children:["New calibration will be:",e.jsxs("div",{className:"calibration-values",children:[e.jsxs("div",{children:[(p*(m/o)).toFixed(2)," pixels/cm"]}),e.jsxs("div",{children:[x(p*(m/o))," mm/pixel"]})]})]}),e.jsx("button",{onClick:()=>v(p*(m/o)),children:"Apply"})]})]})})]})]})})},y=({pixelsPerCm:v,lines:a,onLinesChange:p,showMeasurements:m,onToggleMeasurements:r})=>{const[o,j]=u.useState(null),[f,N]=u.useState([]),[x,i]=u.useState(null),l=(t,s)=>{s.preventDefault();const h=a.find(g=>g.id===t);if(!h)return;j(t);const n="touches"in s?h.isHorizontal?s.touches[0].clientY:s.touches[0].clientX:h.isHorizontal?s.clientY:s.clientX;i({position:h.position,mousePosition:n})},c=(t,s)=>{t.preventDefault(),t.stopPropagation(),p(a.filter(h=>h.id!==s))},d=u.useCallback(t=>{if(!o||!x)return;const s=a.find(b=>b.id===o);if(!s)return;const n=("touches"in t?s.isHorizontal?t.touches[0].clientY:t.touches[0].clientX:s.isHorizontal?t.clientY:t.clientX)-x.mousePosition,g=x.position+n*.1;p(a.map(b=>b.id===o?{...b,position:g}:b))},[o,x,a,p]),w=()=>{j(null),i(null)};return u.useEffect(()=>{const t=a.filter(n=>n.isHorizontal).sort((n,g)=>n.position-g.position),s=a.filter(n=>!n.isHorizontal).sort((n,g)=>n.position-g.position),h=[];for(let n=0;n<t.length-1;n++){const b=Math.abs(t[n+1].position-t[n].position)/v;h.push({id:`${t[n].id}-${t[n+1].id}`,value:Number(b.toFixed(2)),unit:"cm",startLine:t[n].id,endLine:t[n+1].id,isHorizontal:!0})}for(let n=0;n<s.length-1;n++){const b=Math.abs(s[n+1].position-s[n].position)/v;h.push({id:`${s[n].id}-${s[n+1].id}`,value:Number(b.toFixed(2)),unit:"cm",startLine:s[n].id,endLine:s[n+1].id,isHorizontal:!1})}N(h)},[a,v]),u.useEffect(()=>(o&&(window.addEventListener("mousemove",d),window.addEventListener("mouseup",w),window.addEventListener("touchmove",d),window.addEventListener("touchend",w)),()=>{window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",w),window.removeEventListener("touchmove",d),window.removeEventListener("touchend",w)}),[o,d]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"measurement-lines",children:[a.map(t=>e.jsx("div",{className:`measurement-line ${t.isHorizontal?"horizontal":"vertical"}`,style:{[t.isHorizontal?"top":"left"]:`${t.position}px`},onMouseDown:s=>l(t.id,s),onTouchStart:s=>l(t.id,s),onDoubleClick:s=>c(s,t.id),onTouchEnd:s=>{s.timeStamp-s.currentTarget.lastTouch<500&&c(s,t.id),s.currentTarget.lastTouch=s.timeStamp},title:"Double-tap to delete, drag to move"},t.id)),f.map(t=>{const s=a.find(L=>L.id===t.startLine),h=a.find(L=>L.id===t.endLine);if(!s||!h)return null;const n=(s.position+h.position)/2,g=`${t.value}${t.unit}`,b=t.isHorizontal?[{left:"60px",top:`${n}px`,transform:"translateY(-50%)"},{right:"60px",top:`${n}px`,transform:"translateY(-50%)"}]:[{top:"60px",left:`${n}px`,transform:"translateX(-50%)"},{bottom:"60px",left:`${n}px`,transform:"translateX(-50%)"}];return e.jsx(e.Fragment,{children:b.map((L,E)=>e.jsx("div",{className:"measurement-label",style:L,children:g},`${t.id}-${E}`))})})]}),a.length>=2&&e.jsxs("div",{className:`measurements-display ${m?"":"minimized"}`,children:[e.jsxs("div",{className:"measurements-header",children:[e.jsx("h3",{children:"Measurements"}),e.jsx("button",{className:"minimize-button",onClick:r,title:m?"Minimize":"Maximize",children:m?"âˆ’":"+"})]}),m&&e.jsxs("div",{className:"measurement-list",children:[e.jsxs("div",{className:"measurement-section",children:[e.jsx("h4",{children:"Horizontal"}),f.filter(t=>t.isHorizontal).map(t=>e.jsxs("div",{className:"measurement-item",children:[t.value,t.unit]},t.id))]}),e.jsxs("div",{className:"measurement-section",children:[e.jsx("h4",{children:"Vertical"}),f.filter(t=>!t.isHorizontal).map(t=>e.jsxs("div",{className:"measurement-item",children:[t.value,t.unit]},t.id))]})]})]})]})};function D(){const[v,a]=u.useState(()=>{const s=localStorage.getItem("pixelsPerCm");return s?parseFloat(s):37.795275591}),[p,m]=u.useState(!1),[r,o]=u.useState([]),[j,f]=u.useState(!0),[N,x]=u.useState(!0),[i,l]=u.useState(!1),c=s=>{a(s),localStorage.setItem("pixelsPerCm",s.toString())},d=(s,h)=>{o(n=>[...n,{id:Math.random().toString(36).substr(2,9),position:h,isHorizontal:s}]),f(!1),x(!0)},w=u.useCallback(async()=>{try{document.fullscreenElement?(await document.exitFullscreen(),l(!1)):(await document.documentElement.requestFullscreen(),l(!0))}catch(s){console.error("Error toggling fullscreen:",s)}},[]),t=()=>{o([])};return u.useEffect(()=>{const s=h=>{h.touches.length===1&&h.preventDefault()};return document.addEventListener("touchmove",s,{passive:!1}),()=>{document.removeEventListener("touchmove",s)}},[]),e.jsxs("div",{className:"app",children:[e.jsxs("div",{className:"top-buttons",children:[e.jsx("button",{className:"calibrate-button",onClick:()=>m(!0),children:"Calibrate"}),e.jsx("button",{className:"toggle-fullscreen-button",onClick:w,children:i?"Exit Fullscreen":"Fullscreen"}),e.jsx("button",{className:"reset-button",onClick:t,children:"Reset"})]}),j&&e.jsx("div",{className:"measurement-instructions",children:e.jsxs("div",{className:"instruction-box",children:[e.jsx("h3",{children:"How to Use:"}),e.jsxs("ol",{children:[e.jsx("li",{children:"Double-click on the top ruler to create vertical lines"}),e.jsx("li",{children:"Double-click on the left ruler to create horizontal lines"}),e.jsx("li",{children:"Drag lines to measure distances"}),e.jsx("li",{children:"Use the minimize button to hide/show measurements panel"})]})]})}),e.jsx(z,{pixelsPerCm:v,onCreateLine:d}),e.jsx(y,{pixelsPerCm:v,lines:r,onLinesChange:o,showMeasurements:N,onToggleMeasurements:()=>x(!N)}),p&&e.jsx(M,{onCalibrate:c,onClose:()=>m(!1),currentPixelsPerCm:v})]})}S.createRoot(document.getElementById("root")).render(e.jsx(C.StrictMode,{children:e.jsx(D,{})}));
