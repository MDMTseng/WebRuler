import{r as d,j as e,c as C,R as S}from"./react-vendor.Ds7D3P6J.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))u(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const j of o.addedNodes)j.tagName==="LINK"&&j.rel==="modulepreload"&&u(j)}).observe(document,{childList:!0,subtree:!0});function h(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(l){if(l.ep)return;l.ep=!0;const o=h(l);fetch(l.href,o)}})();const y=({pixelsPerCm:f,onCreateLine:a})=>{const[h,u]=d.useState({width:0,height:0});d.useEffect(()=>{const s=()=>{u({width:window.innerWidth,height:window.innerHeight})};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const l=Math.ceil((h.width-50)/f)+10,o=Math.ceil((h.height-50)/f)+10,j=(s,r)=>{s.preventDefault(),s.stopPropagation();const v="touches"in s?r?s.touches[0].clientY:s.touches[0].clientX:r?s.clientY:s.clientX,c=v-50;a(r,c)},x=(s,r)=>{s.preventDefault(),j(s,r)},N=(s,r)=>{s.type==="click"&&s.nativeEvent instanceof MouseEvent&&j(s,r)};return e.jsxs("div",{className:"ruler",children:[e.jsx("div",{className:"horizontal-ruler",onClick:s=>N(s,!1),onTouchStart:s=>x(s,!1),onTouchMove:s=>s.preventDefault(),children:Array.from({length:l*10+1}).map((s,r)=>{const v=r%10===0,c=r%5===0;return e.jsx("div",{className:`tick ${v?"cm":c?"mm5":"mm"}`,style:{left:`${r*f/10}px`},children:v&&e.jsx("span",{className:"label",children:r/10})},r)})}),e.jsx("div",{className:"vertical-ruler",onClick:s=>N(s,!0),onTouchStart:s=>x(s,!0),onTouchMove:s=>s.preventDefault(),children:Array.from({length:o*10+1}).map((s,r)=>{const v=r%10===0,c=r%5===0;return e.jsx("div",{className:`tick ${v?"cm":c?"mm5":"mm"}`,style:{top:`${r*f/10}px`},children:v&&e.jsx("span",{className:"label",children:r/10})},r)})})]})},z=({onCalibrate:f,onClose:a,currentPixelsPerCm:h})=>{const[u,l]=d.useState(10),[o,j]=d.useState(10),x=d.useRef(null),N=c=>{x.current&&!x.current.contains(c.target)&&a()};d.useEffect(()=>{const c=p=>{x.current&&!x.current.contains(p.target)&&a()};return document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[a]);const s=c=>(10/c).toFixed(3),r=c=>{const p=parseFloat(c.target.value);!isNaN(p)&&p>0&&l(p)},v=c=>{const p=parseFloat(c.target.value);!isNaN(p)&&p>0&&j(p)};return e.jsx("div",{className:"calibration-modal",onClick:N,children:e.jsxs("div",{className:"modal-content",ref:x,onClick:c=>c.stopPropagation(),children:[e.jsx("div",{className:"modal-header",children:e.jsx("h2",{children:"Screen Calibration"})}),e.jsxs("div",{className:"modal-body",children:[h&&e.jsxs("div",{className:"current-calibration",children:[e.jsx("p",{children:"Current calibration:"}),e.jsxs("div",{className:"calibration-values",children:[e.jsxs("div",{children:[h.toFixed(5)," pixels/cm"]}),e.jsxs("div",{children:[s(h)," mm/pixel"]})]})]}),e.jsx("div",{className:"calibration-methods",children:h&&e.jsxs("div",{className:"method",children:[e.jsx("h3",{children:"Adjust Current Calibration"}),e.jsx("p",{children:"Fine-tune the current calibration by setting a ratio. For example, to make measurements 10% larger, set 11 / 10."}),e.jsxs("div",{className:"control ratio-control",children:[e.jsxs("div",{className:"ratio-inputs",children:[e.jsx("input",{type:"number",value:u,onChange:r,min:"0.1",step:"0.1"}),e.jsx("span",{className:"ratio-divider",children:"/"}),e.jsx("input",{type:"number",value:o,onChange:v,min:"0.1",step:"0.1"})]}),e.jsxs("div",{className:"ratio-preview",children:["Current adjustment: ",(u/o*100).toFixed(1),"%"]}),u!==o&&e.jsxs("div",{className:"new-calibration-preview",children:["New calibration will be:",e.jsxs("div",{className:"calibration-values",children:[e.jsxs("div",{children:[(h*(u/o)).toFixed(2)," pixels/cm"]}),e.jsxs("div",{children:[s(h*(u/o))," mm/pixel"]})]})]}),e.jsx("button",{onClick:()=>f(h*(u/o)),children:"Apply"})]})]})})]})]})})},M=({pixelsPerCm:f,lines:a,onLinesChange:h,showMeasurements:u,onToggleMeasurements:l})=>{const[o,j]=d.useState(null),[x,N]=d.useState([]),[s,r]=d.useState(null),v=(t,n)=>{n.preventDefault();const m=a.find(g=>g.id===t);if(!m)return;j(t);const i="touches"in n?m.isHorizontal?n.touches[0].clientY:n.touches[0].clientX:m.isHorizontal?n.clientY:n.clientX;r({position:m.position,mousePosition:i})},c=(t,n)=>{t.preventDefault(),t.stopPropagation(),h(a.filter(m=>m.id!==n))},p=d.useCallback(t=>{if(!o||!s)return;const n=a.find(b=>b.id===o);if(!n)return;const i=("touches"in t?n.isHorizontal?t.touches[0].clientY:t.touches[0].clientX:n.isHorizontal?t.clientY:t.clientX)-s.mousePosition,g=s.position+i*.1;h(a.map(b=>b.id===o?{...b,position:g}:b))},[o,s,a,h]),w=()=>{j(null),r(null)};return d.useEffect(()=>{const t=a.filter(i=>i.isHorizontal).sort((i,g)=>i.position-g.position),n=a.filter(i=>!i.isHorizontal).sort((i,g)=>i.position-g.position),m=[];for(let i=0;i<t.length-1;i++){const b=Math.abs(t[i+1].position-t[i].position)/f;m.push({id:`${t[i].id}-${t[i+1].id}`,value:Number(b.toFixed(2)),unit:"cm",startLine:t[i].id,endLine:t[i+1].id,isHorizontal:!0})}for(let i=0;i<n.length-1;i++){const b=Math.abs(n[i+1].position-n[i].position)/f;m.push({id:`${n[i].id}-${n[i+1].id}`,value:Number(b.toFixed(2)),unit:"cm",startLine:n[i].id,endLine:n[i+1].id,isHorizontal:!1})}N(m)},[a,f]),d.useEffect(()=>(o&&(window.addEventListener("mousemove",p),window.addEventListener("mouseup",w),window.addEventListener("touchmove",p),window.addEventListener("touchend",w)),()=>{window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",w),window.removeEventListener("touchmove",p),window.removeEventListener("touchend",w)}),[o,p]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"measurement-lines",children:[a.map(t=>e.jsx("div",{className:`measurement-line ${t.isHorizontal?"horizontal":"vertical"}`,style:{[t.isHorizontal?"top":"left"]:`${t.position}px`},onMouseDown:n=>v(t.id,n),onTouchStart:n=>v(t.id,n),onDoubleClick:n=>c(n,t.id),onTouchEnd:n=>{n.timeStamp-n.currentTarget.lastTouch<500&&c(n,t.id),n.currentTarget.lastTouch=n.timeStamp},title:"Double-tap to delete, drag to move"},t.id)),x.map(t=>{const n=a.find(L=>L.id===t.startLine),m=a.find(L=>L.id===t.endLine);if(!n||!m)return null;const i=(n.position+m.position)/2,g=`${t.value}${t.unit}`,b=t.isHorizontal?[{left:"60px",top:`${i}px`,transform:"translateY(-50%)"},{right:"60px",top:`${i}px`,transform:"translateY(-50%)"}]:[{top:"60px",left:`${i}px`,transform:"translateX(-50%)"},{bottom:"60px",left:`${i}px`,transform:"translateX(-50%)"}];return e.jsx(e.Fragment,{children:b.map((L,E)=>e.jsx("div",{className:"measurement-label",style:L,children:g},`${t.id}-${E}`))})})]}),a.length>=2&&e.jsxs("div",{className:`measurements-display ${u?"":"minimized"}`,children:[e.jsxs("div",{className:"measurements-header",children:[e.jsx("h3",{children:"Measurements"}),e.jsx("button",{className:"minimize-button",onClick:l,title:u?"Minimize":"Maximize",children:u?"âˆ’":"+"})]}),u&&e.jsxs("div",{className:"measurement-list",children:[e.jsxs("div",{className:"measurement-section",children:[e.jsx("h4",{children:"Horizontal"}),x.filter(t=>t.isHorizontal).map(t=>e.jsxs("div",{className:"measurement-item",children:[t.value,t.unit]},t.id))]}),e.jsxs("div",{className:"measurement-section",children:[e.jsx("h4",{children:"Vertical"}),x.filter(t=>!t.isHorizontal).map(t=>e.jsxs("div",{className:"measurement-item",children:[t.value,t.unit]},t.id))]})]})]})]})};function D(){const[f,a]=d.useState(()=>{const n=localStorage.getItem("pixelsPerCm");return n?parseFloat(n):37.795275591}),[h,u]=d.useState(!1),[l,o]=d.useState([]),[j,x]=d.useState(!0),[N,s]=d.useState(!0),[r,v]=d.useState(!1),c=n=>{a(n),localStorage.setItem("pixelsPerCm",n.toString())},p=(n,m)=>{o(i=>[...i,{id:Math.random().toString(36).substr(2,9),position:m,isHorizontal:n}]),x(!1),s(!0)},w=d.useCallback(async()=>{try{document.fullscreenElement?(await document.exitFullscreen(),v(!1)):(await document.documentElement.requestFullscreen(),v(!0))}catch(n){console.error("Error toggling fullscreen:",n)}},[]),t=()=>{o([])};return d.useEffect(()=>{const n=m=>{m.touches.length===1&&m.preventDefault()};return document.addEventListener("touchmove",n,{passive:!1}),()=>{document.removeEventListener("touchmove",n)}},[]),e.jsxs("div",{className:"app",children:[e.jsxs("div",{className:"top-buttons",children:[e.jsx("button",{className:"calibrate-button",onClick:()=>u(!0),children:"Calibrate"}),e.jsx("button",{className:"toggle-fullscreen-button",onClick:w,children:r?"Exit Fullscreen":"Fullscreen"}),e.jsx("button",{className:"reset-button",onClick:t,children:"Reset"})]}),j&&e.jsx("div",{className:"measurement-instructions",children:e.jsxs("div",{className:"instruction-box",children:[e.jsx("h3",{children:"How to Use:"}),e.jsxs("ol",{children:[e.jsx("li",{children:"Double-click on the top ruler to create vertical lines"}),e.jsx("li",{children:"Double-click on the left ruler to create horizontal lines"}),e.jsx("li",{children:"Drag lines to measure distances"}),e.jsx("li",{children:"Use the minimize button to hide/show measurements panel"})]})]})}),e.jsx(y,{pixelsPerCm:f,onCreateLine:p}),e.jsx(M,{pixelsPerCm:f,lines:l,onLinesChange:o,showMeasurements:N,onToggleMeasurements:()=>s(!N)}),h&&e.jsx(z,{onCalibrate:c,onClose:()=>u(!1),currentPixelsPerCm:f})]})}C.createRoot(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(D,{})}));
