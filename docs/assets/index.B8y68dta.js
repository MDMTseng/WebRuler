import{r as m,j as t,c as N,R as S}from"./react-vendor.Ds7D3P6J.js";(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))p(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const x of i.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&p(x)}).observe(document,{childList:!0,subtree:!0});function h(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function p(r){if(r.ep)return;r.ep=!0;const i=h(r);fetch(r.href,i)}})();const C=({pixelsPerCm:f,onCreateLine:u})=>{const[h,p]=m.useState({width:0,height:0}),[r,i]=m.useState(!1);m.useEffect(()=>{const o=()=>{p({width:window.innerWidth,height:window.innerHeight})};return i("ontouchstart"in window),o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]);const x=Math.ceil((h.width-50)/f)+10,w=Math.ceil((h.height-50)/f)+10,j=(o,l)=>{if(r)return;o.preventDefault(),o.stopPropagation();const a=(l?o.clientY:o.clientX)-50;u(l,a)},v=(o,l)=>{o.preventDefault(),o.stopPropagation();const a=(l?o.touches[0].clientY:o.touches[0].clientX)-50;u(l,a)};return t.jsxs("div",{className:"ruler",children:[t.jsx("div",{className:"horizontal-ruler",onClick:r?void 0:o=>j(o,!1),onTouchStart:r?o=>v(o,!1):void 0,onTouchMove:o=>o.preventDefault(),children:Array.from({length:x*10+1}).map((o,l)=>{const c=l%10===0,a=l%5===0;return t.jsx("div",{className:`tick ${c?"cm":a?"mm5":"mm"}`,style:{left:`${l*f/10}px`},children:c&&t.jsx("span",{className:"label",children:l/10})},l)})}),t.jsx("div",{className:"vertical-ruler",onClick:r?void 0:o=>j(o,!0),onTouchStart:r?o=>v(o,!0):void 0,onTouchMove:o=>o.preventDefault(),children:Array.from({length:w*10+1}).map((o,l)=>{const c=l%10===0,a=l%5===0;return t.jsx("div",{className:`tick ${c?"cm":a?"mm5":"mm"}`,style:{top:`${l*f/10}px`},children:c&&t.jsx("span",{className:"label",children:l/10})},l)})})]})},M=({onCalibrate:f,onClose:u,currentPixelsPerCm:h})=>{const[p,r]=m.useState(10),[i,x]=m.useState(10),w=m.useRef(null),j=c=>{w.current&&!w.current.contains(c.target)&&u()};m.useEffect(()=>{const c=a=>{w.current&&!w.current.contains(a.target)&&u()};return document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[u]);const v=c=>(10/c).toFixed(3),o=c=>{const a=parseFloat(c.target.value);!isNaN(a)&&a>0&&r(a)},l=c=>{const a=parseFloat(c.target.value);!isNaN(a)&&a>0&&x(a)};return t.jsx("div",{className:"calibration-modal",onClick:j,children:t.jsxs("div",{className:"modal-content",ref:w,onClick:c=>c.stopPropagation(),children:[t.jsx("div",{className:"modal-header",children:t.jsx("h2",{children:"Screen Calibration"})}),t.jsxs("div",{className:"modal-body",children:[h&&t.jsxs("div",{className:"current-calibration",children:[t.jsx("p",{children:"Current calibration:"}),t.jsxs("div",{className:"calibration-values",children:[t.jsxs("div",{children:[h.toFixed(5)," pixels/cm"]}),t.jsxs("div",{children:[v(h)," mm/pixel"]})]})]}),t.jsx("div",{className:"calibration-methods",children:h&&t.jsxs("div",{className:"method",children:[t.jsx("h3",{children:"Adjust Current Calibration"}),t.jsx("p",{children:"Fine-tune the current calibration by setting a ratio. For example, to make measurements 10% larger, set 11 / 10."}),t.jsxs("div",{className:"control ratio-control",children:[t.jsxs("div",{className:"ratio-inputs",children:[t.jsx("input",{type:"number",value:p,onChange:o,min:"0.1",step:"0.1"}),t.jsx("span",{className:"ratio-divider",children:"/"}),t.jsx("input",{type:"number",value:i,onChange:l,min:"0.1",step:"0.1"})]}),t.jsxs("div",{className:"ratio-preview",children:["Current adjustment: ",(p/i*100).toFixed(1),"%"]}),p!==i&&t.jsxs("div",{className:"new-calibration-preview",children:["New calibration will be:",t.jsxs("div",{className:"calibration-values",children:[t.jsxs("div",{children:[(h*(p/i)).toFixed(2)," pixels/cm"]}),t.jsxs("div",{children:[v(h*(p/i))," mm/pixel"]})]})]}),t.jsx("button",{onClick:()=>f(h*(p/i)),children:"Apply"})]})]})})]})]})})},z=({pixelsPerCm:f,lines:u,onLinesChange:h,showMeasurements:p,onToggleMeasurements:r})=>{const[i,x]=m.useState(null),[w,j]=m.useState([]),[v,o]=m.useState(null),l=(n,e)=>{e.preventDefault();const d=u.find(g=>g.id===n);if(!d)return;x(n);const s="touches"in e?d.isHorizontal?e.touches[0].clientY:e.touches[0].clientX:d.isHorizontal?e.clientY:e.clientX;o({position:d.position,mousePosition:s})},c=(n,e)=>{n.preventDefault(),n.stopPropagation(),h(u.filter(d=>d.id!==e))},a=m.useCallback(n=>{if(!i||!v)return;const e=u.find(b=>b.id===i);if(!e)return;const s=("touches"in n?e.isHorizontal?n.touches[0].clientY:n.touches[0].clientX:e.isHorizontal?n.clientY:n.clientX)-v.mousePosition,g=v.position+s*.1;h(u.map(b=>b.id===i?{...b,position:g}:b))},[i,v,u,h]),E=()=>{x(null),o(null)};return m.useEffect(()=>{const n=u.filter(s=>s.isHorizontal).sort((s,g)=>s.position-g.position),e=u.filter(s=>!s.isHorizontal).sort((s,g)=>s.position-g.position),d=[];for(let s=0;s<n.length-1;s++){const b=Math.abs(n[s+1].position-n[s].position)/f;d.push({id:`${n[s].id}-${n[s+1].id}`,value:Number(b.toFixed(2)),unit:"cm",startLine:n[s].id,endLine:n[s+1].id,isHorizontal:!0})}for(let s=0;s<e.length-1;s++){const b=Math.abs(e[s+1].position-e[s].position)/f;d.push({id:`${e[s].id}-${e[s+1].id}`,value:Number(b.toFixed(2)),unit:"cm",startLine:e[s].id,endLine:e[s+1].id,isHorizontal:!1})}j(d)},[u,f]),m.useEffect(()=>(i&&(window.addEventListener("mousemove",a),window.addEventListener("mouseup",E),window.addEventListener("touchmove",a),window.addEventListener("touchend",E)),()=>{window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",E),window.removeEventListener("touchmove",a),window.removeEventListener("touchend",E)}),[i,a]),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"measurement-lines",children:[u.map(n=>t.jsx("div",{className:`measurement-line ${n.isHorizontal?"horizontal":"vertical"}`,style:{[n.isHorizontal?"top":"left"]:`${n.position}px`},onMouseDown:e=>l(n.id,e),onTouchStart:e=>l(n.id,e),onDoubleClick:e=>c(e,n.id),onTouchEnd:e=>{e.timeStamp-e.currentTarget.lastTouch<500&&c(e,n.id),e.currentTarget.lastTouch=e.timeStamp},title:"Double-tap to delete, drag to move"},n.id)),w.map(n=>{const e=u.find(F=>F.id===n.startLine),d=u.find(F=>F.id===n.endLine);if(!e||!d)return null;const s=(e.position+d.position)/2,g=`${n.value}${n.unit}`,b=n.isHorizontal?[{left:"60px",top:`${s}px`,transform:"translateY(-50%)"},{right:"60px",top:`${s}px`,transform:"translateY(-50%)"}]:[{top:"60px",left:`${s}px`,transform:"translateX(-50%)"},{bottom:"60px",left:`${s}px`,transform:"translateX(-50%)"}];return t.jsx(t.Fragment,{children:b.map((F,L)=>t.jsx("div",{className:"measurement-label",style:F,children:g},`${n.id}-${L}`))})})]}),!1]})};function y(){const[f,u]=m.useState(()=>{const e=localStorage.getItem("pixelsPerCm");return e?parseFloat(e):37.795275591}),[h,p]=m.useState(!1),[r,i]=m.useState([]),[x,w]=m.useState(!0),[j,v]=m.useState(!0),[o,l]=m.useState(!1),c=e=>{u(e),localStorage.setItem("pixelsPerCm",e.toString())},a=(e,d)=>{i(s=>[...s,{id:Math.random().toString(36).substr(2,9),position:d,isHorizontal:e}]),w(!1),v(!0)},E=m.useCallback(async()=>{try{const e=document.documentElement;!document.fullscreenElement&&!document.webkitFullscreenElement&&!document.mozFullScreenElement&&!document.msFullscreenElement?(e.requestFullscreen?await e.requestFullscreen():e.webkitRequestFullscreen?await e.webkitRequestFullscreen():e.mozRequestFullScreen?await e.mozRequestFullScreen():e.msRequestFullscreen&&await e.msRequestFullscreen(),l(!0)):(document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen(),l(!1))}catch(e){console.error("Error toggling fullscreen:",e)}},[]);m.useEffect(()=>{const e=()=>{l(!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement))};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("MSFullscreenChange",e),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e)}},[]),m.useEffect(()=>{if(!document.querySelector("meta[name=viewport]")){const d=document.createElement("meta");d.name="viewport",d.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no",document.head.appendChild(d)}},[]);const n=()=>{i([])};return m.useEffect(()=>{const e=d=>{d.touches.length===1&&d.preventDefault()};return document.addEventListener("touchmove",e,{passive:!1}),()=>{document.removeEventListener("touchmove",e)}},[]),t.jsxs("div",{className:"app",children:[t.jsxs("div",{className:"top-buttons",children:[t.jsx("button",{className:"calibrate-button",onClick:()=>p(!0),children:"Calibrate"}),t.jsx("button",{className:"toggle-fullscreen-button",onClick:E,children:o?"Exit Fullscreen":"Fullscreen"}),t.jsx("button",{className:"reset-button",onClick:n,children:"Reset"})]}),x&&t.jsx("div",{className:"measurement-instructions",children:t.jsxs("div",{className:"instruction-box",children:[t.jsx("h3",{children:"How to Use:"}),t.jsxs("ol",{children:[t.jsx("li",{children:"Double-click on the top ruler to create vertical lines"}),t.jsx("li",{children:"Double-click on the left ruler to create horizontal lines"}),t.jsx("li",{children:"Drag lines to measure distances"}),t.jsx("li",{children:"Use the minimize button to hide/show measurements panel"})]})]})}),t.jsx(C,{pixelsPerCm:f,onCreateLine:a}),t.jsx(z,{pixelsPerCm:f,lines:r,onLinesChange:i,showMeasurements:j,onToggleMeasurements:()=>v(!j)}),h&&t.jsx(M,{onCalibrate:c,onClose:()=>p(!1),currentPixelsPerCm:f})]})}N.createRoot(document.getElementById("root")).render(t.jsx(S.StrictMode,{children:t.jsx(y,{})}));
