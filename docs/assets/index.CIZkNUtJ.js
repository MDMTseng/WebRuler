import{r as u,j as e,c as S,R as E}from"./react-vendor.Ds7D3P6J.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))p(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const j of r.addedNodes)j.tagName==="LINK"&&j.rel==="modulepreload"&&p(j)}).observe(document,{childList:!0,subtree:!0});function m(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function p(a){if(a.ep)return;a.ep=!0;const r=m(a);fetch(a.href,r)}})();const C=({pixelsPerCm:h,onCreateLine:l})=>{const[m,p]=u.useState({width:0,height:0}),[a,r]=u.useState(!1);u.useEffect(()=>{const o=()=>{p({width:window.innerWidth,height:window.innerHeight})};return r("ontouchstart"in window),o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]);const j=Math.ceil((m.width-50)/h)+10,w=Math.ceil((m.height-50)/h)+10,N=(o,d)=>{if(a)return;o.preventDefault(),o.stopPropagation();const n=(d?o.clientY:o.clientX)-50;l(d,n)},f=(o,d)=>{o.preventDefault(),o.stopPropagation();const n=(d?o.touches[0].clientY:o.touches[0].clientX)-50;l(d,n)};return e.jsxs("div",{className:"ruler",children:[e.jsx("div",{className:"horizontal-ruler",onClick:a?void 0:o=>N(o,!1),onTouchStart:a?o=>f(o,!1):void 0,onTouchMove:o=>o.preventDefault(),children:Array.from({length:j*10+1}).map((o,d)=>{const c=d%10===0,n=d%5===0;return e.jsx("div",{className:`tick ${c?"cm":n?"mm5":"mm"}`,style:{left:`${d*h/10}px`},children:c&&e.jsx("span",{className:"label",children:d/10})},d)})}),e.jsx("div",{className:"vertical-ruler",onClick:a?void 0:o=>N(o,!0),onTouchStart:a?o=>f(o,!0):void 0,onTouchMove:o=>o.preventDefault(),children:Array.from({length:w*10+1}).map((o,d)=>{const c=d%10===0,n=d%5===0;return e.jsx("div",{className:`tick ${c?"cm":n?"mm5":"mm"}`,style:{top:`${d*h/10}px`},children:c&&e.jsx("span",{className:"label",children:d/10})},d)})})]})},D=({onCalibrate:h,onClose:l,currentPixelsPerCm:m})=>{const[p,a]=u.useState(10),[r,j]=u.useState(10),w=u.useRef(null),N=c=>{w.current&&!w.current.contains(c.target)&&l()};u.useEffect(()=>{const c=n=>{w.current&&!w.current.contains(n.target)&&l()};return document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[l]);const f=c=>(10/c).toFixed(3),o=c=>{const n=parseFloat(c.target.value);!isNaN(n)&&n>0&&a(n)},d=c=>{const n=parseFloat(c.target.value);!isNaN(n)&&n>0&&j(n)};return e.jsx("div",{className:"calibration-modal",onClick:N,children:e.jsxs("div",{className:"modal-content",ref:w,onClick:c=>c.stopPropagation(),children:[e.jsx("div",{className:"modal-header",children:e.jsx("h2",{children:"Screen Calibration"})}),e.jsxs("div",{className:"modal-body",children:[m&&e.jsxs("div",{className:"current-calibration",children:[e.jsx("p",{children:"Current calibration:"}),e.jsxs("div",{className:"calibration-values",children:[e.jsxs("div",{children:[m.toFixed(5)," pixels/cm"]}),e.jsxs("div",{children:[f(m)," mm/pixel"]})]})]}),e.jsx("div",{className:"calibration-methods",children:m&&e.jsxs("div",{className:"method",children:[e.jsx("h3",{children:"Adjust Current Calibration"}),e.jsx("p",{children:"Fine-tune the current calibration by setting a ratio. For example, to make measurements 10% larger, set 11 / 10."}),e.jsxs("div",{className:"control ratio-control",children:[e.jsxs("div",{className:"ratio-inputs",children:[e.jsx("input",{type:"number",value:p,onChange:o,min:"0.1",step:"0.1"}),e.jsx("span",{className:"ratio-divider",children:"/"}),e.jsx("input",{type:"number",value:r,onChange:d,min:"0.1",step:"0.1"})]}),e.jsxs("div",{className:"ratio-preview",children:["Current adjustment: ",(p/r*100).toFixed(1),"%"]}),p!==r&&e.jsxs("div",{className:"new-calibration-preview",children:["New calibration will be:",e.jsxs("div",{className:"calibration-values",children:[e.jsxs("div",{children:[(m*(p/r)).toFixed(2)," pixels/cm"]}),e.jsxs("div",{children:[f(m*(p/r))," mm/pixel"]})]})]}),e.jsx("button",{onClick:()=>h(m*(p/r)),children:"Apply"})]})]})})]})]})})},y=({pixelsPerCm:h,lines:l,onLinesChange:m,showMeasurements:p,onToggleMeasurements:a})=>{const[r,j]=u.useState(null),[w,N]=u.useState([]),[f,o]=u.useState(null),d=(t,s)=>{s.preventDefault();const v=l.find(g=>g.id===t);if(!v)return;j(t);const i="touches"in s?v.isHorizontal?s.touches[0].clientY:s.touches[0].clientX:v.isHorizontal?s.clientY:s.clientX;o({position:v.position,mousePosition:i})},c=(t,s)=>{t.preventDefault(),t.stopPropagation(),m(l.filter(v=>v.id!==s))},n=u.useCallback(t=>{if(!r||!f)return;const s=l.find(b=>b.id===r);if(!s)return;const i=("touches"in t?s.isHorizontal?t.touches[0].clientY:t.touches[0].clientX:s.isHorizontal?t.clientY:t.clientX)-f.mousePosition,g=f.position+i*.3;m(l.map(b=>b.id===r?{...b,position:g}:b))},[r,f,l,m]),x=()=>{j(null),o(null)};return u.useEffect(()=>{const t=l.filter(i=>i.isHorizontal).sort((i,g)=>i.position-g.position),s=l.filter(i=>!i.isHorizontal).sort((i,g)=>i.position-g.position),v=[];for(let i=0;i<t.length-1;i++){const b=Math.abs(t[i+1].position-t[i].position)/h;v.push({id:`${t[i].id}-${t[i+1].id}`,value:Number(b.toFixed(2)),unit:"cm",startLine:t[i].id,endLine:t[i+1].id,isHorizontal:!0})}for(let i=0;i<s.length-1;i++){const b=Math.abs(s[i+1].position-s[i].position)/h;v.push({id:`${s[i].id}-${s[i+1].id}`,value:Number(b.toFixed(2)),unit:"cm",startLine:s[i].id,endLine:s[i+1].id,isHorizontal:!1})}N(v)},[l,h]),u.useEffect(()=>(r&&(window.addEventListener("mousemove",n),window.addEventListener("mouseup",x),window.addEventListener("touchmove",n),window.addEventListener("touchend",x)),()=>{window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",x),window.removeEventListener("touchmove",n),window.removeEventListener("touchend",x)}),[r,n]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"measurement-lines",children:[l.map(t=>e.jsx("div",{className:`measurement-line ${t.isHorizontal?"horizontal":"vertical"}`,style:{[t.isHorizontal?"top":"left"]:`${t.position}px`},onMouseDown:s=>d(t.id,s),onTouchStart:s=>d(t.id,s),onDoubleClick:s=>c(s,t.id),onTouchEnd:s=>{s.timeStamp-s.currentTarget.lastTouch<500&&c(s,t.id),s.currentTarget.lastTouch=s.timeStamp},title:"Double-tap to delete, drag to move"},t.id)),w.map(t=>{const s=l.find(L=>L.id===t.startLine),v=l.find(L=>L.id===t.endLine);if(!s||!v)return null;const i=(s.position+v.position)/2,g=`${t.value}${t.unit}`,b=t.isHorizontal?[{left:"60px",top:`${i}px`,transform:"translateY(-50%)"},{right:"60px",top:`${i}px`,transform:"translateY(-50%)"}]:[{top:"60px",left:`${i}px`,transform:"translateX(-50%)"},{bottom:"60px",left:`${i}px`,transform:"translateX(-50%)"}];return e.jsx(e.Fragment,{children:b.map((L,M)=>e.jsx("div",{className:"measurement-label",style:L,children:g},`${t.id}-${M}`))})})]}),!1]})};function z(){const[h,l]=u.useState(()=>{const n=localStorage.getItem("pixelsPerCm");return n?parseFloat(n):37.795275591}),[m,p]=u.useState(!1),[a,r]=u.useState([]),[j,w]=u.useState(!0),[N,f]=u.useState(!0),o=n=>{l(n),localStorage.setItem("pixelsPerCm",n.toString())},d=(n,x)=>{r(t=>[...t,{id:Math.random().toString(36).substr(2,9),position:x,isHorizontal:n}]),w(!1),f(!0)};u.useEffect(()=>{if(!document.querySelector("meta[name=viewport]")){const x=document.createElement("meta");x.name="viewport",x.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no",document.head.appendChild(x)}},[]);const c=()=>{r([])};return u.useEffect(()=>{const n=x=>{x.touches.length===1&&x.preventDefault()};return document.addEventListener("touchmove",n,{passive:!1}),()=>{document.removeEventListener("touchmove",n)}},[]),e.jsxs("div",{className:"app",children:[e.jsxs("div",{className:"top-buttons",children:[e.jsx("button",{className:"calibrate-button",onClick:()=>p(!0),title:"Calibrate"}),e.jsx("button",{className:"reset-button",onClick:c,title:"Reset"})]}),j&&e.jsx("div",{className:"measurement-instructions",children:e.jsxs("div",{className:"instruction-box",children:[e.jsx("h3",{children:"How to Use:"}),e.jsxs("ol",{children:[e.jsx("li",{children:"Double-click on the top ruler to create vertical lines"}),e.jsx("li",{children:"Double-click on the left ruler to create horizontal lines"}),e.jsx("li",{children:"Drag lines to measure distances"}),e.jsx("li",{children:"Use the minimize button to hide/show measurements panel"})]})]})}),e.jsx(C,{pixelsPerCm:h,onCreateLine:d}),e.jsx(y,{pixelsPerCm:h,lines:a,onLinesChange:r,showMeasurements:N,onToggleMeasurements:()=>f(!N)}),m&&e.jsx(D,{onCalibrate:o,onClose:()=>p(!1),currentPixelsPerCm:h})]})}S.createRoot(document.getElementById("root")).render(e.jsx(E.StrictMode,{children:e.jsx(z,{})}));
